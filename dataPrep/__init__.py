# %%

import json

with open("d:/Downloads/nvdcve-1.1-2013.json/nvdcve-1.1-2013.json", 'r', encoding='utf8') as cve_import_file:
    cve_list = json.load(cve_import_file)


def find_cpe23uri_in_dict(input: dict):
    output = []

    if isinstance(input, dict):
        if 'cpe23Uri' in input:
            output.append(input['cpe23Uri'])
        else:

            for key, value in input.items():
                result = find_cpe23uri_in_dict(value)

                if result:
                    for item in result:
                        output.append(item)

    elif isinstance(input, list):
        for listitem in input:
            result = find_cpe23uri_in_dict(listitem)

            if result:
                for resultitem in result:
                    output.append(resultitem)

    else:
        return None

    return output

cve_config_list = []
for cve in cve_list['CVE_Items']:

    vulnerable_stuff = []
    for node in cve['configurations']['nodes']:
        for item in find_cpe23uri_in_dict(node):
            vulnerable_stuff.append(item)

    cve_config_list.append(vulnerable_stuff)
    # print(vulnerable_stuff)

print(cve_config_list)
