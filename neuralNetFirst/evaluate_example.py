import os

from neuralNetFirst.nn_config import *
from neuralNetFirst import build_model, load_data

print("Building model")
model = build_model(DAYS, POSTS_PER_DAY, EMBEDDING_LENGTH, MAX_WORDS_PER_POST, TARGET_VECTOR_LENGTH, threshold = 0.09)

print("Loading model weights")
model.load_weights(os.path.join(model_directory_path, 'model_weights'))

print("Loading data")
features_shape = (DAYS, POSTS_PER_DAY, MAX_WORDS_PER_POST, EMBEDDING_LENGTH)
evaluate_data = load_data(data_directory_path, features_shape, TARGET_VECTOR_LENGTH, n_rows=284,
                           batches=16)

print("Evaluating data")
print(model.evaluate(evaluate_data, steps=16))

#print('Trying a single row')
#evaluate_data = load_data(data_directory_path, features_shape, TARGET_VECTOR_LENGTH, n_rows=1, batches=1)
#print(model.predict(evaluate_data))
