import os

from neuralNetFirst.nn_config import *
from neuralNetFirst import build_model
from neuralNetFirst.run_training import load_data

model = build_model(DAYS, POSTS_PER_DAY, EMBEDDING_LENGTH, MAX_WORDS_PER_POST, TARGET_VECTOR_LENGTH)

model.load_weights(os.path.join(model_directory_path, 'model_weights'))

features_shape = (DAYS, POSTS_PER_DAY, MAX_WORDS_PER_POST, EMBEDDING_LENGTH)
evaluate_data = load_data(data_directory_path, data_file, features_shape, TARGET_VECTOR_LENGTH)

print(model.evaluate(evaluate_data))
