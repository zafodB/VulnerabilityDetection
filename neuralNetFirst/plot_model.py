from tensorflow.keras.utils import plot_model

from neuralNetFirst import build_model, initial_setup
from neuralNetFirst.nn_config import *

if RUN_GPU_CONFIG:
    initial_setup()

print("Starting up")

features_shape = (DAYS, POSTS_PER_DAY, MAX_WORDS_PER_POST, EMBEDDING_LENGTH)

model = build_model(DAYS, POSTS_PER_DAY, EMBEDDING_LENGTH, MAX_WORDS_PER_POST, TARGET_VECTOR_LENGTH)

plot_model(model, to_file='model_plot.png', dpi=256, show_shapes=False, show_layer_names=True)
